<!DOCTYPE html><html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/><title>java script 模版引擎初探 | MartinDelophy</title><meta name="viewport" content="width=640"/><link rel="stylesheet" href="/style.css"/></head><body><header><section><a class="nav-home" href="/">MartinDelophy</a><nav><a href="/blog">技术博客</a><a href="/#">个人简历</a><a href="/#">图标3</a><a href="/#" class="active">图标4</a><a href="/#">图标5</a></nav><div class="algolia-search-wrapper"><input type="text" id="algolia-search-input" placeholder="请搜索..."/></div></section></header><section><div class="documentationContent"><div class="inner-content"><h1>java script 模版引擎初探</h1><p>2018-5-18 by MartinDelophy</p><hr/><div><p>模版引擎，众所周知就是将你需要绑定的值从后端传到前端，帮助用户解决变量预留的问题。</p><p>那么我的想法就是去构建一个模版引擎，帮助用户去解决这个问题。
那么，首先我们应该怎么做呢？
我的设计想法如下：</p><div><div width="100%" style="overflow-x: auto;"> 
<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="571" height="315" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[html->jsbox: bypass context
jsbox->js: extract value bypass value
js-jsbox: find value bind value
jsbox-html: find context bind context]]></source><desc></desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"></g><g class="actor"><path d="M10,20C36.3,22.4 37.4,17.6 70.7,20.0C69.0,44.0 72.4,26.8 70.7,62.5C56.2,64.9 53.0,60.1 10.0,62.5C8.3,30.2 11.7,52.3 10.0,20.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="20" y="44" style="font-size: 16px; font-family: danielbd;"><tspan x="20">html</tspan></text></g><g class="actor"><path d="M10,252.5C19.7,250.1 27.4,254.9 70.7,252.5C69.0,284.8 72.4,277.3 70.7,295.0C49.9,297.4 46.3,292.6 10.0,295.0C11.7,283.5 8.3,259.3 10.0,252.5" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="20" y="276.5" style="font-size: 16px; font-family: danielbd;"><tspan x="20">html</tspan></text></g><path d="M40.4,62.5C32.8,206.9 48.0,109.5 40.4,252.5" stroke="#000000" fill="none" style="stroke-width: 2;"></path><g class="actor"><path d="M246.109375,20C272.3,22.6 292.8,17.4 310.3,20.0C308.6,47.1 312.0,45.3 310.3,62.5C268.7,65.1 272.9,59.9 246.1,62.5C247.8,54.1 244.4,29.6 246.1,20.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="257.34375" y="44" style="font-size: 16px; font-family: danielbd;"><tspan x="256.109375">jsbox</tspan></text></g><g class="actor"><path d="M246.109375,252.5C287.1,249.9 256.4,255.1 310.3,252.5C312.0,288.2 308.6,274.2 310.3,295.0C257.1,292.4 261.5,297.6 246.1,295.0C244.4,272.3 247.8,284.1 246.1,252.5" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="257.34375" y="276.5" style="font-size: 16px; font-family: danielbd;"><tspan x="256.109375">jsbox</tspan></text></g><path d="M278.2,62.5C270.6,191.2 285.8,193.9 278.2,252.5" stroke="#000000" fill="none" style="stroke-width: 2;"></path><g class="actor"><path d="M506.984375,20C515.4,21.4 517.8,18.6 541.9,20.0C543.6,30.0 540.2,30.2 541.9,62.5C515.4,61.1 517.3,63.9 507.0,62.5C505.3,26.8 508.7,52.2 507.0,20.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="518.21875" y="44" style="font-size: 16px; font-family: danielbd;"><tspan x="516.984375">js</tspan></text></g><g class="actor"><path d="M506.984375,252.5C535.0,253.9 520.0,251.1 541.9,252.5C540.2,262.7 543.6,268.6 541.9,295.0C526.9,293.6 524.4,296.4 507.0,295.0C505.3,259.3 508.7,277.1 507.0,252.5" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="518.21875" y="276.5" style="font-size: 16px; font-family: danielbd;"><tspan x="516.984375">js</tspan></text></g><path d="M524.5,62.5C516.9,165.2 532.1,114.0 524.5,252.5" stroke="#000000" fill="none" style="stroke-width: 2;"></path><g class="signal"><text x="95.6328125" y="90.25" style="font-size: 16px; font-family: danielbd;"><tspan x="95.6328125">bypass context</tspan></text><path d="M40.4,105.0C163.7,114.5 78.4,95.5 278.2,105.0" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="288.2265625" y="132.75" style="font-size: 16px; font-family: danielbd;"><tspan x="288.2265625">extract value bypass value</tspan></text><path d="M278.2,147.5C326.4,137.7 337.3,157.3 524.5,147.5" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="313.5625" y="175.25" style="font-size: 16px; font-family: danielbd;"><tspan x="313.5625">find value bind value</tspan></text><path d="M524.5,190.0C458.0,199.8 337.3,180.2 278.2,190.0" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="50.3671875" y="217.75" style="font-size: 16px; font-family: danielbd;"><tspan x="50.3671875">find context bind context</tspan></text><path d="M278.2,232.5C203.6,242.0 97.5,223.0 40.4,232.5" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g></svg>
</div>


</div><p>首先，将html的整个内容塞到 jsbox 中，之后将内容中的有效绑定字段进行提取，传到后端，解析字段。
通过后端拿到相应的字段的值，绑定之后推到jsbox中，在将jsbox中的内容推到前端进行渲染。</p><p>为了验证这个想法，我写了一个demo，地址在：<a href="https://github.com/MartinDelophy/narko">https://github.com/MartinDelophy/narko</a>
相应的demo在test文件夹中，可以通过npm install 来对本模版引擎进行安装。
当然，这个模版有很多的地方需要改进，比如多网页模版，组建生命周期，双向绑定。</p></div></div><div class="nav-docs"><div class="nav-docs-section"><h3>Subscribe</h3><a rel="home" type="application/rss+xml" href="/blog/rss.xml">RSS</a></div><div class="nav-docs-section"><h3>Recent Posts</h3><ul><li><a href="/blog/java-backengineering/">java 反向工程</a></li><li><a href="/blog/continous-publish/">持续发布项目</a></li><li>java script 模版引擎初探</li><li><a href="/blog/java-jvm2/">浅谈 node-jvm(2)</a></li><li><a href="/blog/java-jvm/">浅谈 node-jvm(1)</a></li><li><a href="/blog/java-annotation/">java 注解</a></li></ul></div></div></div></section><footer><section><a class="footer-home" href="/">MartinDelophy powered by graphql.org</a></section></footer></body></html>        <canvas id="live2d" width="260" height="300" className="live_2d" style="position:fixed;right:0px;bottom:0px" /><script src="/static/js/live2d.min.js"></script><!DOCTYPE html><html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/><title>java script 模版引擎初探 | MartinDelophy</title><meta name="viewport" content="width=640"/><link rel="stylesheet" href="/style.css"/></head><body><header><section><a class="nav-home" href="/">MartinDelophy</a><nav><a href="/blog">技术博客</a><a href="/#">个人简历</a><a href="/#">图标3</a><a href="/#" class="active">图标4</a><a href="/#">图标5</a></nav><div class="algolia-search-wrapper"><input type="text" id="algolia-search-input" placeholder="请搜索..."/></div></section></header><section><div class="documentationContent"><div class="inner-content"><h1>java script 模版引擎初探</h1><p>2018-5-18 by MartinDelophy</p><hr/><div><p>模版引擎，众所周知就是将你需要绑定的值从后端传到前端，帮助用户解决变量预留的问题。</p><p>那么我的想法就是去构建一个模版引擎，帮助用户去解决这个问题。
那么，首先我们应该怎么做呢？
我的设计想法如下：</p><div><div width="100%" style="overflow-x: auto;"> 
<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="571" height="315" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[html->jsbox: bypass context
jsbox->js: extract value bypass value
js-jsbox: find value bind value
jsbox-html: find context bind context]]></source><desc></desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"></g><g class="actor"><path d="M10,20C36.3,22.4 37.4,17.6 70.7,20.0C69.0,44.0 72.4,26.8 70.7,62.5C56.2,64.9 53.0,60.1 10.0,62.5C8.3,30.2 11.7,52.3 10.0,20.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="20" y="44" style="font-size: 16px; font-family: danielbd;"><tspan x="20">html</tspan></text></g><g class="actor"><path d="M10,252.5C19.7,250.1 27.4,254.9 70.7,252.5C69.0,284.8 72.4,277.3 70.7,295.0C49.9,297.4 46.3,292.6 10.0,295.0C11.7,283.5 8.3,259.3 10.0,252.5" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="20" y="276.5" style="font-size: 16px; font-family: danielbd;"><tspan x="20">html</tspan></text></g><path d="M40.4,62.5C32.8,206.9 48.0,109.5 40.4,252.5" stroke="#000000" fill="none" style="stroke-width: 2;"></path><g class="actor"><path d="M246.109375,20C272.3,22.6 292.8,17.4 310.3,20.0C308.6,47.1 312.0,45.3 310.3,62.5C268.7,65.1 272.9,59.9 246.1,62.5C247.8,54.1 244.4,29.6 246.1,20.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="257.34375" y="44" style="font-size: 16px; font-family: danielbd;"><tspan x="256.109375">jsbox</tspan></text></g><g class="actor"><path d="M246.109375,252.5C287.1,249.9 256.4,255.1 310.3,252.5C312.0,288.2 308.6,274.2 310.3,295.0C257.1,292.4 261.5,297.6 246.1,295.0C244.4,272.3 247.8,284.1 246.1,252.5" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="257.34375" y="276.5" style="font-size: 16px; font-family: danielbd;"><tspan x="256.109375">jsbox</tspan></text></g><path d="M278.2,62.5C270.6,191.2 285.8,193.9 278.2,252.5" stroke="#000000" fill="none" style="stroke-width: 2;"></path><g class="actor"><path d="M506.984375,20C515.4,21.4 517.8,18.6 541.9,20.0C543.6,30.0 540.2,30.2 541.9,62.5C515.4,61.1 517.3,63.9 507.0,62.5C505.3,26.8 508.7,52.2 507.0,20.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="518.21875" y="44" style="font-size: 16px; font-family: danielbd;"><tspan x="516.984375">js</tspan></text></g><g class="actor"><path d="M506.984375,252.5C535.0,253.9 520.0,251.1 541.9,252.5C540.2,262.7 543.6,268.6 541.9,295.0C526.9,293.6 524.4,296.4 507.0,295.0C505.3,259.3 508.7,277.1 507.0,252.5" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="518.21875" y="276.5" style="font-size: 16px; font-family: danielbd;"><tspan x="516.984375">js</tspan></text></g><path d="M524.5,62.5C516.9,165.2 532.1,114.0 524.5,252.5" stroke="#000000" fill="none" style="stroke-width: 2;"></path><g class="signal"><text x="95.6328125" y="90.25" style="font-size: 16px; font-family: danielbd;"><tspan x="95.6328125">bypass context</tspan></text><path d="M40.4,105.0C163.7,114.5 78.4,95.5 278.2,105.0" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="288.2265625" y="132.75" style="font-size: 16px; font-family: danielbd;"><tspan x="288.2265625">extract value bypass value</tspan></text><path d="M278.2,147.5C326.4,137.7 337.3,157.3 524.5,147.5" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="313.5625" y="175.25" style="font-size: 16px; font-family: danielbd;"><tspan x="313.5625">find value bind value</tspan></text><path d="M524.5,190.0C458.0,199.8 337.3,180.2 278.2,190.0" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="50.3671875" y="217.75" style="font-size: 16px; font-family: danielbd;"><tspan x="50.3671875">find context bind context</tspan></text><path d="M278.2,232.5C203.6,242.0 97.5,223.0 40.4,232.5" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g></svg>
</div>


</div><p>首先，将html的整个内容塞到 jsbox 中，之后将内容中的有效绑定字段进行提取，传到后端，解析字段。
通过后端拿到相应的字段的值，绑定之后推到jsbox中，在将jsbox中的内容推到前端进行渲染。</p><p>为了验证这个想法，我写了一个demo，地址在：<a href="https://github.com/MartinDelophy/narko">https://github.com/MartinDelophy/narko</a>
相应的demo在test文件夹中，可以通过npm install 来对本模版引擎进行安装。
当然，这个模版有很多的地方需要改进，比如多网页模版，组建生命周期，双向绑定。</p></div></div><div class="nav-docs"><div class="nav-docs-section"><h3>Subscribe</h3><a rel="home" type="application/rss+xml" href="/blog/rss.xml">RSS</a></div><div class="nav-docs-section"><h3>Recent Posts</h3><ul><li><a href="/blog/java-backengineering/">java 反向工程</a></li><li><a href="/blog/continous-publish/">持续发布项目</a></li><li>java script 模版引擎初探</li><li><a href="/blog/java-jvm2/">浅谈 node-jvm(2)</a></li><li><a href="/blog/java-jvm/">浅谈 node-jvm(1)</a></li><li><a href="/blog/java-annotation/">java 注解</a></li></ul></div></div></div></section><footer><section><a class="footer-home" href="/">MartinDelophy powered by graphql.org</a></section></footer></body></html><script>if (!this.readyState || this.readyState == "complete") { window.loadlive2d("live2d","/static/live2d-widget-model-shizuku/assets/shizuku.model.json") }</script>